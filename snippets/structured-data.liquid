{%- comment -%}
  Centralized JSON-LD Structured Data
  Includes: Product, Article, Breadcrumb, Review, FAQ, LocalBusiness
{%- endcomment -%}

{%- if template contains 'product' and product -%}     
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "Product",
    "name": {{ product.title | json }},
    "image": [
      {{ product.featured_image | image_url: width: 800 | json }}
    ],
    "description": {{ product.description | strip_html | truncatewords: 50 | json }},
    "sku": {{ product.sku | json }},
    "brand": {
      "@type": "Brand",
      "name": {{ product.vendor | json }}
    },
    "offers": {
      "@type": "Offer",
      "priceCurrency": {{ shop.currency | json }},
      "price": {{ product.price | divided_by: 100.0 }},
      "availability": "https://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
      "url": {{ product.url | within: collection | json }}
    }
  {% if product.metafields.reviews.rating.value %}
    ,"aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": {{ product.metafields.reviews.rating.value }},
      "reviewCount": {{ product.metafields.reviews.rating_count.value }}
    }
  {% endif %}
  }
  </script>
{%- endif -%}

{%- if template contains 'article' and article -%}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": {{ article.title | json }},
    "image": {{ article.image | image_url: width: 800 | json }},
    "datePublished": "{{ article.published_at | date: '%Y-%m-%d' }}",
    "dateModified": "{{ article.updated_at | date: '%Y-%m-%d' }}",
    "author": {
      "@type": "Person",
      "name": {{ article.author | json }}
    },
    "publisher": {
      "@type": "Organization",
      "name": {{ shop.name | json }},
      "logo": {
        "@type": "ImageObject",
        "url": {{ settings.logo | image_url: width: 200 | json }}
      }
    },
    "description": {{ article.excerpt_or_content | strip_html | truncatewords: 50 | json }}
  }
  </script>
{%- endif -%}

{%- if product and collection -%}
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "{{ shop.url }}"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": {{ collection.title | json }},
        "item": "{{ shop.url }}{{ collection.url }}"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": {{ product.title | json }},
        "item": "{{ shop.url }}{{ product.url }}"
      }
    ]
  }
  </script>
{%- endif -%}

{%- if template == 'index' -%}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": {{ shop.name | json }},
  "url": "{{ shop.url }}",
  "logo": {{ settings.logo | image_url: width: 200 | json }}
}
</script>
{%- endif -%}